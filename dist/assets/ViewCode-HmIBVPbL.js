import{G as b,r as s,b as y,u as j,j as e,a as v,B as l}from"./index-CVcYMcyB.js";import{f as N}from"./format-BzRktsyD.js";import{a as k}from"./axiosProfile-CMomThzU.js";import{s as r}from"./socket-BFX5HE9S.js";function C(a){return b({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12.1",cy:"12.1",r:"1"},child:[]}]})(a)}function S({textCode:a,time:d,textInfo:i,shouldUpdate:c,textName:h}){const[f,m]=s.useState(null),[x,w]=s.useState("txt");s.useEffect(()=>{y.toDataURL(window.location.href).then(m)},[]);const p=j(),u=()=>{let n=new Blob([i],{type:"text/plain"}),g=URL.createObjectURL(n);const o=document.createElement("a");o.setAttribute("href",g),o.download=Date.now()+"."+x,o.click()};return e.jsxs("aside",{className:"md:w-[350px] p-2 md:h-full border-r-2 border-zinc-100 flex-shrink-0 w-full border-2",children:[e.jsxs("div",{className:"flex flex-col gap-3 bg-white shadow rounded p-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-start font-bold text-xl text-indigo-600",children:"Name :"}),e.jsxs("span",{children:[" ",h]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-start font-bold text-xl text-indigo-600",children:"Created at :"}),e.jsxs("span",{children:[" ",N(d,"yyyy-MM-dd HH:mm:ss")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-start font-bold text-xl text-indigo-600",children:"Code :"}),e.jsxs("span",{children:[" ",a]})]})]}),e.jsxs("div",{className:"w-full shadow p-2 mt-2",children:[e.jsx("h1",{className:"w-full py-3 bg-indigo-500 rounded text-center font-bold text-xl text-white",children:"Qr Code"}),e.jsx(E,{qrCode:f})]}),e.jsxs("div",{className:"w-full  p-3 gap-2 shadow flex items-center",children:[e.jsxs("div",{className:"h-full px-2 py-2 text-black flex items-center",children:[e.jsx(C,{size:20}),e.jsx("input",{type:"text",className:"w-10 outline-none",value:x,onChange:n=>w(n.target.value)})]}),e.jsx("button",{onClick:u,className:"flex-grow text-center py-2 rounded shadow bg-violet-500 text-white",children:"Download Code"})]}),c&&e.jsx("div",{className:"w-full  p-3 gap-2 shadow flex items-center",children:e.jsx("button",{className:"text-center py-2 rounded shadow bg-sky-500 tracking-wider text-lg text-white w-full",disabled:!c,onClick:n=>p(`/edit/${a}`),children:"edit"})})]})}function E({qrCode:a}){return e.jsx("div",{className:"md:w-[300px] md:h-[300px] w-[200px] mx-auto p-2 overflow-hidden rounded bg-red-300 my-2",children:e.jsx("img",{src:a,alt:"qr code",className:"w-full h-full object-cover aspect-square"})})}function U(){const[a,d]=s.useState("Welcome to TextShare.vardhan.works, the easiest way to share text online using unique codes and you can download the text also. Our platform allows you to create pages for text sharing with just a simple code, enabling fast and secure content sharing over the web. On the View page, users can quickly access the shared content by entering their unique code. If no code is entered, you'll see a default placeholder text showcasing how the system works. Whether youâ€™re sharing notes, messages, or important information, TextShare makes it hassle-free and secure."),[i,c]=s.useState("0000"),[h,f]=s.useState(Date.now()),[m,x]=s.useState(!1),[w,p]=s.useState("");let{search:u}=v();const n=j();async function g(o){try{const t=await k.get("/view-text",{params:{code:o}});t.data.status==="success"?(d(t.data.data.textInfo),f(t.data.data.createdAt),x(t.data.data.shouldUpdate),p(t.data.data.textName)):(l.error(t.data.msg),l.info("redirecting in 2seconds"),setTimeout(()=>{n("/")},2e3))}catch{l.error("something went wrong")}}return s.useEffect(()=>{let t=new URLSearchParams(u).get("code");if(!t||t.length!=4){l.error("Not a valid Code"),l.info("Redirecting in 3 seconds"),setTimeout(()=>{n("/")},3e3);return}t&&(c(t),g(t))},[u]),s.useEffect(()=>(r.connect(),r.emit("join_room",{code:i}),()=>{r.off("join_room"),r.disconnect()}),[i]),s.useEffect(()=>(r.on("update_message",o=>{d(o)}),()=>{r.off("update_message")}),[]),e.jsx(e.Fragment,{children:e.jsxs("main",{className:"flex gap-2 flex-col md:flex-row h-[87vh] shadow",children:[e.jsx(S,{textCode:i,time:h,textInfo:a,shouldUpdate:m,textName:w}),e.jsx("section",{className:"flex-grow p-3 overflow-hidden text-wrap overflow-y-auto h-full",style:{userSelect:"text",whiteSpace:"pre-wrap"},children:a})]})})}export{U as default};
